*Heading
Three-dimensional neuron migration 
**
**	UNITS:	Length - meters, Time - sec, Angle - radians,
**		Temperature - Kelvin, Force - Newtons,
**		Stress - Newton/meter^2 = Pa, Mass - kilograms,
**		Density - kg/meter^3, Conductivity - Watt/m-K,
**		Specific Heat - J/m^3-K, Energy - Joules,
**	        Chemical potential - Joules/mole,
**		Fluid content - moles/volume
**
** Shuolun Wang 
**
************************************************************************
**			PARAMETERS
************************************************************************
*Parameter
**	MATERIAL PROPERTIES
**
** smooth parameter for neuron cell migration  
alpha = 0.1
**
** smooth parameter for source term 
**alpha_Gc = 20.0
alpha_Gc = 100.0
**
** smooth parameter for velocity 
**alpha_v = 20.0
alpha_v = 100.0
**
** smooth parameter for diffusivity 
alpha_d = 100.0
** 
** smooth parameter for stiffness 
alpha_mu = 100.0
**alpha_mu = 50.0
**
** smooth parameter for growth parameter 
alpha_k = 20.0
**
**
** base value for source term
**Gc = 5.0
Gc = 25.0
**
** base value for velocity
***vel = 0.2
vel = 0.01
**
** diffusivity
***diff = 0.01
diff = 0.0005
**
** cell migration threshold 
***c0 = 400.0 
c0 = 100.0 
**
** shape parameter for growth
k_s = 0.0
betak = 1.0
k_c_normal = k_s*betak
k_c_para = k_s/betak
alpha_normal = 1.0 
alpha_para = 1.0
**
** mechanical parameter(Pa) 
lam_s = 930.0
mu_s = 100.0
**
** stiffness ratio 
betaE = 10.0 
lam_c = lam_s*betaE
mu_c = mu_s*betaE
**
** delta function parameter for Gc as function of time
epsilon1 = 20.0
**
**
**
**	ELEMENT PROPERTIES
**
** number of volume integration points
nInt = 8
**
** number of local sdv's used in the solution
nlSdv = 10
**
** number of global sdv's used for visualization
ngSdv = 10
**
** number of element variables
nVars = nInt*nlSdv
**
**
**	BOUNDARY AND INITIAL CONDITIONS
**
** loading/irradiation times (sec)
time = 500.0
**
**
**
** initial neuron cell density  
initc = 0.0
**
**
************************************************************************
**		MODEL DEFINITION
************************************************************************
*System
          0.,        0.08,0.0199999999999999,6.12323399573677e-17,        0.08,       -0.98
          0.,        1.08,0.0199999999999999
*Node
      1, 0.0199999996, 0.0199999996,           1.
      2, 0.0199999996, -0.0799999982,           1.
      3, 0.0199999996, 0.0199999996,  0.966666639
      4, 0.0199999996, -0.0799999982,  0.966666639
      5, 0.0199999996, 0.0199999996,  0.933333337
      6, 0.0199999996, -0.0799999982,  0.933333337
      7, 0.0199999996, 0.0199999996,  0.899999976
      8, 0.0199999996, -0.0799999982,  0.899999976
      9, 0.0199999996, 0.0199999996,  0.866666675
     10, 0.0199999996, -0.0799999982,  0.866666675
     11, 0.0199999996, 0.0199999996,  0.833333313
     12, 0.0199999996, -0.0799999982,  0.833333313
     13, 0.0199999996, 0.0199999996,  0.800000012
     14, 0.0199999996, -0.0799999982,  0.800000012
     15, 0.0199999996, 0.0199999996,  0.766666651
     16, 0.0199999996, -0.0799999982,  0.766666651
     17, 0.0199999996, 0.0199999996,  0.733333349
     18, 0.0199999996, -0.0799999982,  0.733333349
     19, 0.0199999996, 0.0199999996,  0.699999988
     20, 0.0199999996, -0.0799999982,  0.699999988
     21, 0.0199999996, 0.0199999996,  0.666666687
     22, 0.0199999996, -0.0799999982,  0.666666687
     23, 0.0199999996, 0.0199999996,  0.633333325
     24, 0.0199999996, -0.0799999982,  0.633333325
     25, 0.0199999996, 0.0199999996,  0.600000024
     26, 0.0199999996, -0.0799999982,  0.600000024
     27, 0.0199999996, 0.0199999996,  0.566666663
     28, 0.0199999996, -0.0799999982,  0.566666663
     29, 0.0199999996, 0.0199999996,  0.533333361
     30, 0.0199999996, -0.0799999982,  0.533333361
     31, 0.0199999996, 0.0199999996,          0.5
     32, 0.0199999996, -0.0799999982,          0.5
     33, 0.0199999996, 0.0199999996,  0.466666669
     34, 0.0199999996, -0.0799999982,  0.466666669
     35, 0.0199999996, 0.0199999996,  0.433333337
     36, 0.0199999996, -0.0799999982,  0.433333337
     37, 0.0199999996, 0.0199999996,  0.400000006
     38, 0.0199999996, -0.0799999982,  0.400000006
     39, 0.0199999996, 0.0199999996,  0.366666675
     40, 0.0199999996, -0.0799999982,  0.366666675
     41, 0.0199999996, 0.0199999996,  0.333333343
     42, 0.0199999996, -0.0799999982,  0.333333343
     43, 0.0199999996, 0.0199999996,  0.300000012
     44, 0.0199999996, -0.0799999982,  0.300000012
     45, 0.0199999996, 0.0199999996,  0.266666681
     46, 0.0199999996, -0.0799999982,  0.266666681
     47, 0.0199999996, 0.0199999996,  0.233333334
     48, 0.0199999996, -0.0799999982,  0.233333334
     49, 0.0199999996, 0.0199999996,  0.200000003
     50, 0.0199999996, -0.0799999982,  0.200000003
     51, 0.0199999996, 0.0199999996,  0.166666672
     52, 0.0199999996, -0.0799999982,  0.166666672
     53, 0.0199999996, 0.0199999996,   0.13333334
     54, 0.0199999996, -0.0799999982,   0.13333334
     55, 0.0199999996, 0.0199999996,  0.100000001
     56, 0.0199999996, -0.0799999982,  0.100000001
     57, 0.0199999996, 0.0199999996, 0.0666666701
     58, 0.0199999996, -0.0799999982, 0.0666666701
     59, 0.0199999996, 0.0199999996, 0.0333333351
     60, 0.0199999996, -0.0799999982, 0.0333333351
     61, 0.0199999996, 0.0199999996,           0.
     62, 0.0199999996, -0.0799999982,           0.
     63, -0.0799999982, 0.0199999996,           1.
     64, -0.0799999982, -0.0799999982,           1.
     65, -0.0799999982, 0.0199999996,  0.966666639
     66, -0.0799999982, -0.0799999982,  0.966666639
     67, -0.0799999982, 0.0199999996,  0.933333337
     68, -0.0799999982, -0.0799999982,  0.933333337
     69, -0.0799999982, 0.0199999996,  0.899999976
     70, -0.0799999982, -0.0799999982,  0.899999976
     71, -0.0799999982, 0.0199999996,  0.866666675
     72, -0.0799999982, -0.0799999982,  0.866666675
     73, -0.0799999982, 0.0199999996,  0.833333313
     74, -0.0799999982, -0.0799999982,  0.833333313
     75, -0.0799999982, 0.0199999996,  0.800000012
     76, -0.0799999982, -0.0799999982,  0.800000012
     77, -0.0799999982, 0.0199999996,  0.766666651
     78, -0.0799999982, -0.0799999982,  0.766666651
     79, -0.0799999982, 0.0199999996,  0.733333349
     80, -0.0799999982, -0.0799999982,  0.733333349
     81, -0.0799999982, 0.0199999996,  0.699999988
     82, -0.0799999982, -0.0799999982,  0.699999988
     83, -0.0799999982, 0.0199999996,  0.666666687
     84, -0.0799999982, -0.0799999982,  0.666666687
     85, -0.0799999982, 0.0199999996,  0.633333325
     86, -0.0799999982, -0.0799999982,  0.633333325
     87, -0.0799999982, 0.0199999996,  0.600000024
     88, -0.0799999982, -0.0799999982,  0.600000024
     89, -0.0799999982, 0.0199999996,  0.566666663
     90, -0.0799999982, -0.0799999982,  0.566666663
     91, -0.0799999982, 0.0199999996,  0.533333361
     92, -0.0799999982, -0.0799999982,  0.533333361
     93, -0.0799999982, 0.0199999996,          0.5
     94, -0.0799999982, -0.0799999982,          0.5
     95, -0.0799999982, 0.0199999996,  0.466666669
     96, -0.0799999982, -0.0799999982,  0.466666669
     97, -0.0799999982, 0.0199999996,  0.433333337
     98, -0.0799999982, -0.0799999982,  0.433333337
     99, -0.0799999982, 0.0199999996,  0.400000006
    100, -0.0799999982, -0.0799999982,  0.400000006
    101, -0.0799999982, 0.0199999996,  0.366666675
    102, -0.0799999982, -0.0799999982,  0.366666675
    103, -0.0799999982, 0.0199999996,  0.333333343
    104, -0.0799999982, -0.0799999982,  0.333333343
    105, -0.0799999982, 0.0199999996,  0.300000012
    106, -0.0799999982, -0.0799999982,  0.300000012
    107, -0.0799999982, 0.0199999996,  0.266666681
    108, -0.0799999982, -0.0799999982,  0.266666681
    109, -0.0799999982, 0.0199999996,  0.233333334
    110, -0.0799999982, -0.0799999982,  0.233333334
    111, -0.0799999982, 0.0199999996,  0.200000003
    112, -0.0799999982, -0.0799999982,  0.200000003
    113, -0.0799999982, 0.0199999996,  0.166666672
    114, -0.0799999982, -0.0799999982,  0.166666672
    115, -0.0799999982, 0.0199999996,   0.13333334
    116, -0.0799999982, -0.0799999982,   0.13333334
    117, -0.0799999982, 0.0199999996,  0.100000001
    118, -0.0799999982, -0.0799999982,  0.100000001
    119, -0.0799999982, 0.0199999996, 0.0666666701
    120, -0.0799999982, -0.0799999982, 0.0666666701
    121, -0.0799999982, 0.0199999996, 0.0333333351
    122, -0.0799999982, -0.0799999982, 0.0333333351
    123, -0.0799999982, 0.0199999996,           0.
    124, -0.0799999982, -0.0799999982,           0.
*User Element,Nodes=8,Type=U3,Iproperties=3,Properties=20,Coordinates=3,Variables=<nVars>,Unsymm
1,2,3,11
*Element, type=U3
 1,  63,  64,  66,  65,   1,   2,   4,   3
 2,  65,  66,  68,  67,   3,   4,   6,   5
 3,  67,  68,  70,  69,   5,   6,   8,   7
 4,  69,  70,  72,  71,   7,   8,  10,   9
 5,  71,  72,  74,  73,   9,  10,  12,  11
 6,  73,  74,  76,  75,  11,  12,  14,  13
 7,  75,  76,  78,  77,  13,  14,  16,  15
 8,  77,  78,  80,  79,  15,  16,  18,  17
 9,  79,  80,  82,  81,  17,  18,  20,  19
10,  81,  82,  84,  83,  19,  20,  22,  21
11,  83,  84,  86,  85,  21,  22,  24,  23
12,  85,  86,  88,  87,  23,  24,  26,  25
13,  87,  88,  90,  89,  25,  26,  28,  27
14,  89,  90,  92,  91,  27,  28,  30,  29
15,  91,  92,  94,  93,  29,  30,  32,  31
16,  93,  94,  96,  95,  31,  32,  34,  33
17,  95,  96,  98,  97,  33,  34,  36,  35
18,  97,  98, 100,  99,  35,  36,  38,  37
19,  99, 100, 102, 101,  37,  38,  40,  39
20, 101, 102, 104, 103,  39,  40,  42,  41
21, 103, 104, 106, 105,  41,  42,  44,  43
22, 105, 106, 108, 107,  43,  44,  46,  45
23, 107, 108, 110, 109,  45,  46,  48,  47
24, 109, 110, 112, 111,  47,  48,  50,  49
25, 111, 112, 114, 113,  49,  50,  52,  51
26, 113, 114, 116, 115,  51,  52,  54,  53
27, 115, 116, 118, 117,  53,  54,  56,  55
28, 117, 118, 120, 119,  55,  56,  58,  57
29, 119, 120, 122, 121,  57,  58,  60,  59
30, 121, 122, 124, 123,  59,  60,  62,  61
*Nset, nset=block-1_Set-1, generate
   1,  124,    1
*Elset, elset=block-1_Set-1, generate
  1,  30,   1
** Section: Section-1
*System
*Nset, nset=all, generate
   1,  124,    1
*Elset, elset=all, generate
  1,  30,   1
*Nset, nset=fixface_x
  61,  62, 123, 124
*Elset, elset=fixface_x
 30,
*Nset, nset=fixface_y, generate
   1,  124,    1
*Elset, elset=fixface_y, generate
  1,  30,   1
*Nset, nset=fixface_z, generate
   1,  124,    1
*Elset, elset=fixface_z, generate
  1,  30,   1
*Nset, nset=sideline, generate
  63,  123,    2
*Elset, elset=sideline, generate
  1,  30,   1
** Make the dummy mesh, shares nodes with the real mesh,
**  allows visualization of the results, access to 
**  hourglass controls, and access to mechanical, 
**  traction-type boundary conditions
*Element, type=C3D8
10001,  63,  64,  66,  65,   1,   2,   4,   3
10002,  65,  66,  68,  67,   3,   4,   6,   5
10003,  67,  68,  70,  69,   5,   6,   8,   7
10004,  69,  70,  72,  71,   7,   8,  10,   9
10005,  71,  72,  74,  73,   9,  10,  12,  11
10006,  73,  74,  76,  75,  11,  12,  14,  13
10007,  75,  76,  78,  77,  13,  14,  16,  15
10008,  77,  78,  80,  79,  15,  16,  18,  17
10009,  79,  80,  82,  81,  17,  18,  20,  19
10010,  81,  82,  84,  83,  19,  20,  22,  21
10011,  83,  84,  86,  85,  21,  22,  24,  23
10012,  85,  86,  88,  87,  23,  24,  26,  25
10013,  87,  88,  90,  89,  25,  26,  28,  27
10014,  89,  90,  92,  91,  27,  28,  30,  29
10015,  91,  92,  94,  93,  29,  30,  32,  31
10016,  93,  94,  96,  95,  31,  32,  34,  33
10017,  95,  96,  98,  97,  33,  34,  36,  35
10018,  97,  98, 100,  99,  35,  36,  38,  37
10019,  99, 100, 102, 101,  37,  38,  40,  39
10020, 101, 102, 104, 103,  39,  40,  42,  41
10021, 103, 104, 106, 105,  41,  42,  44,  43
10022, 105, 106, 108, 107,  43,  44,  46,  45
10023, 107, 108, 110, 109,  45,  46,  48,  47
10024, 109, 110, 112, 111,  47,  48,  50,  49
10025, 111, 112, 114, 113,  49,  50,  52,  51
10026, 113, 114, 116, 115,  51,  52,  54,  53
10027, 115, 116, 118, 117,  53,  54,  56,  55
10028, 117, 118, 120, 119,  55,  56,  58,  57
10029, 119, 120, 122, 121,  57,  58,  60,  59
10030, 121, 122, 124, 123,  59,  60,  62,  61
*Elset, elset=ElDummy, generate
10001,  10030,    1
**
** make a dummy element which is not connected to anything with CPE4T
**  just so that we can have the coupled thermal-displacement step
**
*Node
999996,  0.0, 0.0
999997,  .000001, 0.0
999998,  .000001, .000001
999999,  0.0, .000001
*Nset, nset=tempElement
999996,999997,999998,999999
*Element, Type=CPE4T
999999,999996,999997,999998,999999
*Elset,elset=tempElement
999999
************************************************************************
**			MATERIAL DEFINITION
************************************************************************
**
** Material properties for the real material
**
*uel property,elset=all
<alpha>,<alpha_Gc>,<alpha_v>,<alpha_d>,<alpha_mu>,<alpha_k>,<Gc>,<vel>,
<diff>,<c0>,<k_s>,<k_c_normal>,<k_c_para>,<alpha_normal>,<alpha_para>,<lam_c>,
<lam_s>,<mu_c>,<mu_s>,<epsilon1>,<nlSdv>,<ngSdv>,<nInt>
**
** Dummy mesh material properties
**
*Solid section, elset=tempElement, material=Material-2
*Solid section, elset=ElDummy, material=Material-1
**
*Material, name=Material-2
*Elastic
1.e-20
*Conductivity
1.0
*Density
1.0
*Specific heat
1.0
**
*Material, name=Material-1
*User output variables
<ngSdv>
*Elastic
1.e-20
**
** 
**
************************************************************************
**			INITIAL CONDITIONS
************************************************************************
**
*Initial conditions, type=temperature
all,<initc>
**
*Initial conditions, type=temperature
tempElement,0.0
**
************************************************************************
**			STEP DEFINITION
************************************************************************
*Step, Name=migration, nlgeom=yes, inc=100000
*Coupled temperature-displacement, steady state
0.1,<time>,1.e-6,10.0
*CONTROLS, PARAMETERS=LINE SEARCH
10,1.0,0.0001,0.25,0.10
*CONTROLS, PARAMETERS=TIME INCREMENTATION
,,,,,,,20,,,,,,
**
*Boundary
***all,1,2,3
fixface_x,1,1
fixface_y,2,2
fixface_z,3,3
**
*Boundary
tempElement,encastre
tempElement,11,11,0.0
**
*Output, field
*node output, nset=all
u,nt
*element output, elset=ElDummy
uvarm,le
*End Step
